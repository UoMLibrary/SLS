<style>@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;src:local('Open Sans Light'),local('OpenSans-Light'),url(https://fonts.gstatic.com/s/opensans/v17/mem5YaGs126MiZpBA-UN_r8OUuhs.ttf) format('truetype')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;src:local('Open Sans Regular'),local('OpenSans-Regular'),url(https://fonts.gstatic.com/s/opensans/v17/mem8YaGs126MiZpBA-UFVZ0e.ttf) format('truetype')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;src:local('Open Sans SemiBold'),local('OpenSans-SemiBold'),url(https://fonts.gstatic.com/s/opensans/v17/mem5YaGs126MiZpBA-UNirkOUuhs.ttf) format('truetype')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;src:local('Open Sans Bold'),local('OpenSans-Bold'),url(https://fonts.gstatic.com/s/opensans/v17/mem5YaGs126MiZpBA-UN7rgOUuhs.ttf) format('truetype')}</style><style>*,input,select{font-family:'Open Sans',sans-serif;font-weight:400}.featured{background:#c39;color:#fff;padding:6px 24px!important;position:relative;left:-12px!important;top:1px!important;border-radius:0!important;font-size:1.3em;font-weight:400}.mle_item{margin:3em 0 .5em;border-top:2px solid rgba(0,0,0,.1);padding:.5em 1em;font-size:95%}.mle_title{font-weight:400;font-size:1.85em;line-height:1em;margin:0;padding:1em 0 .4em;color:#1d1d1d}.mle_description{font-size:1.2em;line-height:2em;padding:0 0 1em;color:#343536;font-weight:400}.mle_button{border:solid 1px #609;background-color:#609;display:block;color:#fff;padding:5px;border-radius:4px;margin:1em 0;width:20%;text-align:center}.mle_category_button,.mle_clear_filters_button{display:inline-block;padding:5px 10px;margin-right:5px;margin-bottom:10px}.mle_clear_filters_button{color:#fff;text-decoration:none;background-color:#383a3c;border-radius:4px;border:1px solid #383a3c}.mle_category_button{background:#fff;border-radius:8px;border:1px solid #c39}.mle_category_button_inactive{color:#c39}.mle_category_button_active{background:#c39;color:#fff}.mle_format_button{background:#fff;display:inline-block;padding:5px 10px;margin-right:5px;border-radius:8px;margin-bottom:10px;border:1px solid #609}.mle_format_button_inactive{color:#609}.mle_format_button_active{background:#609;color:#fff}.disable-selection{-moz-user-select:none;-ms-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-webkit-touch-callout:none}.hand-cursor{cursor:pointer}.mle_description_large{float:left;width:80%}.mle_button_large{float:right;width:20%}.mle_button_large a{width:70%;margin:auto}</style><!-- ng-cloak style --><style>[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
        display: none !important;
    }</style><!-- article used to respect global.css styling --><div class="mainContentContainer" ng-app="mleOnlineResources" ng-controller="mainController"><!-- Loading --><div ng-if="!loaded"><h3>Loading online resource information</h3></div><div ng-if="loaded" ng-cloak><!-- Format filter buttons --><div><div class="mle_format_button disable-selection hand-cursor" ng-class="formatFilters.includes(format) ? 'mle_format_button_active' : 'mle_format_button_inactive'" ng-repeat="format in formats" ng-click="formatToggle(format)">{{format}}</div></div><!-- Category tag filter buttons --><div><div class="mle_category_button disable-selection hand-cursor" ng-class="categoryFilters.includes(tag) ? 'mle_category_button_active' : 'mle_category_button_inactive'" ng-repeat="tag in tags" ng-click="categoryToggle(tag)">{{tag}}</div></div><!-- Clear filters button --><div class="mle_clear_filters_button disable-selection hand-cursor" ng-click="clearFilters()">Clear filters</div><!-- Resources collection --><div ng-repeat="resource in resources"><!-- Individual Resource --><div class="mle_item" ng-if="filterCategories.length == 0 || shouldResourceBeDisplayed(resource)"><span ng-if="resource.featured" class="featured">Featured</span><h3 class="mle_title">{{resource.title}}</h3><div class="mle_description"><div ng-class="{'mle_description_large': width > 800}">{{resource.description}}</div><div ng-class="{'mle_button_large': width > 800}" ng-if="!isSoundCloudLink(resource.link)"><a style="color:#ffffff; text-decoration: none;" class="mle_button disable-selection hand-cursor" ng-click="launchResource(resource.link)"><span style="width:100%;">Launch</span> <img alt="" src="https://www.library.manchester.ac.uk/assets/images/local/bullet-more-white.png"></a></div><div ng-if="isSoundCloudLink(resource.link)"><iframe width="100%" height="200" scrolling="no" frameborder="no" allow="autoplay" ng-src="{{generateSoundCloudIframeUrl(resource.link)}}"></iframe></div><div style="clear: both;"></div></div></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.7.8/angular.min.js"></script><script>var defaultResources="%5B%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Using%20specialist%20business%20databases%22%2C%22description%22%3A%22Guides%20written%20to%20help%20students%20and%20researchers%20to%20make%20effective%20and%20accurate%20use%20of%20the%20specialist%20financial%20and%20business%20databases%20available%20at%20The%20University%20of%20Manchester.%20The%20guides%20are%20organised%20by%20database%2C%20including%20Bloomberg%20and%20Datastream.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22business%20data%22%2C%22link%22%3A%22https%3A//medium.com/using-specialist-business-databases%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Business%20Data%20Service%3A%20Virtual%20Consultation%20%28beta%29%22%2C%22description%22%3A%22Search%20some%20of%20our%20previous%20research%20consultation%20enquiries%20and%20detailed%20answers.%20They%20cover%20a%20selection%20of%20financial%2C%20economic%20and%20business%20data%20sources.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22business%20data%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/sls/bds-vc/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Copyright%20for%20teaching%20materials%3A%20can%20I%20use%20it%3F%22%2C%22description%22%3A%22This%20short%20online%20resource%20will%20help%20you%20to%20determine%20whether%20you%20can%20use%20specific%20types%20of%20material%20in%20your%20teaching%2C%20without%20breaching%20copyright.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22copyright%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/copyright/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Copyright%20for%20student%3A%20Who%20owns%20what%3F%22%2C%22description%22%3A%22This%20resource%20provides%20a%20basic%20introduction%20to%20copyright%2C%20whilst%20looking%20how%20it%20can%20affect%20you%20as%20a%20student.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22copyright%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/copyright-students/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Adding%20up%3A%20describing%20data%20and%20choosing%20a%20statistical%20test%22%2C%22description%22%3A%22This%20resource%20will%20explore%20the%20methods%20and%20descriptives%20you%20can%20use%20to%20describe%20your%20data.%20It%20will%20also%20show%20you%20how%20to%20select%20appropriate%20statistical%20tests%20and%20find%20them%20in%20SPSS.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22maths%20and%20stats%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/mle/statistics-describing-data/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Adding%20up%3A%20introducing%20SPSS%22%2C%22description%22%3A%22This%20resource%20explores%20some%20of%20the%20key%20features%20and%20interfaces%20of%20SPSS%2C%20which%20you%20can%20use%20to%20generate%20reports%2C%20charts%2C%20descriptive%20statistics%20and%20analysis.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22maths%20and%20stats%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/mle/spss/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Adding%20up%3A%20introduction%20to%20statistics%22%2C%22description%22%3A%22This%20resource%20will%20give%20you%20a%20basic%20introduction%20to%20statistical%20terminology%2C%20charts%20and%20data%20types.%20It%20will%20also%20give%20you%20advice%20on%20how%20to%20organise%20your%20data%20to%20make%20it%20easier%20to%20analyse%20and%20present.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22maths%20and%20stats%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/mle/introducing-statistics/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Getting%20started%20with%20EndNote%20desktop%22%2C%22description%22%3A%22This%20resource%20explores%20some%20of%20the%20key%20features%20of%20EndNote%20desktop%20%20reference%20management%20software.%20It%20includes%20video%20demonstrations%20in%20how%20to%20collect%2C%20organise%20and%20format%20your%20references.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/@uomspecialistlibrarysupport/e199b1f9e525%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Getting%20started%20with%20EndNote%20online%22%2C%22description%22%3A%22This%20resource%20explores%20some%20of%20the%20key%20features%20of%20EndNote%20online%20%20reference%20management%20software.%20It%20includes%20video%20demonstrations%20in%20how%20to%20collect%2C%20organise%20and%20format%20your%20references.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/p/ec4acc50bda9/edit%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20desktop%20%22%2C%22description%22%3A%22This%20video%20playlist%20will%20take%20you%20through%20the%20essential%20steps%20to%20using%20EndNote%20desktop%20software%20for%20managing%20your%20references.%20%22%2C%22format%22%3A%22Video%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//www.youtube.com/watch%3Fv%3DNyS3SWDwoXA%26list%3DPL-0DcDKUVRLsmg1uyT03wPwtqn9YfXvwR%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20online%22%2C%22description%22%3A%22This%20video%20playlist%20will%20take%20you%20through%20the%20essential%20steps%20to%20using%20EndNote%20online%20software%20for%20managing%20your%20references.%20%22%2C%22format%22%3A%22Video%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22www.google.com%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Specialist%20Library%20Support%20YouTube%20channel%22%2C%22description%22%3A%22Welcome%20to%20the%20University%20of%20Manchester%20Library%27s%20Specialist%20Learning%20Support%20YouTube%20channel%20for%20students%20and%20staff.%20This%20resource%20is%20here%20to%20help%20you%20develop%20your%20skills%20across%20areas%20that%20include%3A%5Cn%5Cn%u2022%20%20Referencing%5Cn%u2022%20%20Advanced%20searching%20and%20systematic%20review%5Cn%u2022%20%20Business%20data%20and%20statistics.%5Cn%5CnThese%20videos%20will%20help%20you%20get%20started%21%5Cn%5Cn%22%2C%22format%22%3A%22Video%22%2C%22tags%22%3A%5B%22business%20data%22%2C%22maths%20and%20stats%22%2C%22referencing%22%2C%22advanced%20searching%22%2C%22systematic%20review%22%2C%22copyright%22%5D%2C%22link%22%3A%22https%3A//www.youtube.com/channel/UCGcVnSXEzhpNHhz1UHz5MyA%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Copyright%20Guidance%20at%20The%20University%20of%20Manchester%22%2C%22description%22%3A%22This%20guide%20will%20help%20you%20to%20find%20out%20how%20copyright%20affects%20your%20work%2C%20research%20and%20study%20here%20at%20the%20University%20of%20Manchester.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22copyright%22%2C%22link%22%3A%22http%3A//subjects.library.manchester.ac.uk/copyright%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Start%20to%20finish%3A%20Statistics%22%2C%22description%22%3A%22This%20guide%20can%20help%20you%20to%20analyse%20a%20data%20set%20and%20produce%20a%20range%20of%20statistics.%20It%20includes%20three%20key%20areas%3A%20a%20basic%20introduction%20to%20statistics%2C%20describing%20data%20choosing%20a%20statisticial%20test%20and%20an%20introduction%20to%20producing%20reports%20in%20SPSS.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22maths%20and%20stats%22%2C%22link%22%3A%22https%3A//www.escholar.manchester.ac.uk/learning-objects/mle/packages/statistics/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Referencing%20guide%20at%20the%20University%20of%20Manchester%22%2C%22description%22%3A%22This%20guide%20explores%20the%20basics%20of%20referencing%20including%20key%20referencing%20styles%20used%20at%20Manchester%20and%20popular%20referencing%20software%20such%20as%20Endnote%2C%20Mendeley%20and%20Zotero.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22http%3A//subjects.library.manchester.ac.uk/referencing%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Data%20%26%20Statistics%20guide%20at%20the%20University%20of%20Manchester%22%2C%22description%22%3A%22This%20guide%20provides%20information%20for%20University%20of%20Manchester%20students%20and%20staff%20on%20how%20to%20understand%20and%20use%20data%20effectively%2C%20support%20for%20statistical%20support%20and%20statistis%20resources%20for%20the%20UK%2C%20EU%20and%20International%20regions.%5CnYou%20will%20find%20these%20resources%20useful%20for%20locating%20statistics%20in%20books%2C%20journal%20articles%2C%20databases%20and%20on%20the%20web.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%5B%22maths%20and%20stats%22%2C%22business%20data%22%5D%2C%22link%22%3A%22http%3A//subjects.library.manchester.ac.uk/data/%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Specialist%20Library%20Support%20online%20publication%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%5B%22business%20data%22%2C%22maths%20and%20stats%22%2C%22referencing%22%2C%22advanced%20searching%22%2C%22systematic%20review%22%2C%22copyright%22%5D%2C%22link%22%3A%22https%3A//medium.com/specialist-learning-support%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20desktop%3A%20collecting%20references%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/endnote-desktop-collecting-references-1dc25d7f5473%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20desktop%3A%20getting%20started%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/endnote-desktop-getting-started-e199b1f9e525%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20desktop%3A%20organising%20your%20references%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/endnote-desktop-organising-your-references-288ab8248858%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22EndNote%20desktop%3A%20formatting%20your%20references%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22referencing%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/endnote-desktop-formatting-your-references-ccc9852220e4%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Trade%20and%20Industry%20news%3A%20an%20introduction%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22business%20data%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/trade-and-industry-news-an-introduction-5d5de5d82635%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Trade%20%26%20industry%20news%3A%20finding%20specific%20publications%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22business%20data%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/trade-and-industry-news-finding-specific-publications-c0c7b8211d1f%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Making%20use%20of%20MeSH%20and%20Suggested%20Subject%20Terms%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22systematic%20review%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/making-use-of-mesh-and-suggested-subject-terms-efce820a7f26%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Introduction%20to%20Health%20Science%20databases%22%2C%22description%22%3A%22Hi%20friend%2C%20I%20am%20a%20description.%20I%20am%20kind%20of%20generic%2C%20which%20is%20good%20in%20some%20ways%2C%20but%20not%20so%20in%20others%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%22systematic%20review%22%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/introduction-to-health-science-databases-fb2c0669beb1%22%7D%2C%7B%22featured%22%3Afalse%2C%22title%20%22%3A%22Understanding%20your%20data%22%2C%22description%22%3A%22In%20this%20post%20you%20will%20learn%20about%20data%20types%20and%20best%20practices%20for%20structuring%20your%20data.%22%2C%22format%22%3A%22Interactive%20guide%22%2C%22tags%22%3A%5B%22business%20data%22%2C%22maths%20and%20stats%22%2C%22referencing%22%2C%22advanced%20searching%22%2C%22systematic%20review%22%2C%22copyright%22%5D%2C%22link%22%3A%22https%3A//medium.com/specialist-library-support/understanding-your-data-e8325000ffa6%22%7D%5D";</script><script>var config={resourcesJsonUrl:"https://raw.githubusercontent.com/UoMLibrary/SLS/master/src/resources.json"};</script><script>var app = angular.module(
    'mleOnlineResources',
    []
);

app.config(
    function($locationProvider) {
        $locationProvider.html5Mode({enabled: true, requireBase: false});
    }
);

app.controller(
    'mainController',
    function($http, $scope, $window, $location, $sce) {

        var updateQuery = function() {
            $location.search({
                level2Links: $scope.categoryFilters.join(",")
            });
        };

        var getCurrentWidth = function() {
            return $window.innerWidth;
        };

        $scope.width =  getCurrentWidth();
        angular.element($window).bind('resize', function(){
            $scope.width = getCurrentWidth();
            $scope.$digest(); // manual $digest required as resize event is outside angular
        });


        $scope.loaded = false;

        const updateResources = function(resources) {

            // resources = decodeURI(resources);
            // resources = JSON.parse(resources);
            console.log(resources);

            // extract tags from resources
            var tagsSet = {};
            for(var i = 0; i < resources.length; i++) {
                var resource = resources[i];
                var tags = resource.tags;
                for(var j = 0; j < tags.length; j++) {
                    var tag = tags[j];
                    if(tag.includes(" - ")) {
                        tag = tag.split(" - ")[0];
                    }
                    if(!tagsSet[tag]) {
                        tagsSet[tag] = true;
                    }
                }
            }
            var tags = [];
            for(var tag in tagsSet) {
                tags.push(tag);
            }
            tags.sort();

            // extract format from resources
            var formatSet = {};
            for(var i = 0; i < resources.length; i++) {
                var resource = resources[i];
                var format = resource.format;
                if(!formatSet[format]) {
                    formatSet[format] = true;
                }
            }
            var formats = [];
            for(var format in formatSet) {
                formats.push(format);
            }
            formats.sort();

            // sort features (make featured resources at beginning of array)
            resources.sort(
                function(a, b) {
                    const aWeight = a.featured ? 0 : 1;
                    const bWeight = b.featured ? 0 : 1;
                    return aWeight - bWeight;
                }
            );

            $scope.resources = resources;
            $scope.tags = tags;
            $scope.formats = formats;

            $scope.loaded = true;

        };

        // Interpret query parameters
        var query = $location.search();
        if(query.level2Links) {
            var categoryFilters = query.level2Links.replace(/,$/, '').split(',');
            if(categoryFilters && categoryFilters.length > 0 && categoryFilters[0] !== '')
            {
                for(var i = 0; i < categoryFilters.length; i++) {
                    if(categoryFilters[i].includes(" - ")) {
                        categoryFilters[i] = categoryFilters[i].split(" - ")[0];
                    }
                }
                $scope.categoryFilters = categoryFilters;
            }
            // $scope.categoryFilters = query.level2Links.replace(/,$/, '').split(',');
        } else {
            $scope.categoryFilters = [];
        }

        // -- Handle resource input
        // Embedded static resources
        if(defaultResources) {
            console.log("using static resources");
            updateResources(JSON.parse(unescape(defaultResources)));
        }
        // External dynamic resources
        if(query.resourcesSource || config.resourcesJsonUrl) {

            var dynamicResourcesUrl;
            if(query.resourcesSource) {
                console.log("from query");
                dynamicResourcesUrl = decodeURI(query.resourcesSource);
            }
            else if(config.resourcesJsonUrl) {
                console.log("from config");
                dynamicResourcesUrl = config.resourcesJsonUrl;
            }

            console.log("using external resources: " + dynamicResourcesUrl);

            $http
                .get(dynamicResourcesUrl)
                .then(
                    function(response) {
                        updateResources(response.data)
                    }
                );
        }

        // Start of SoundCloud related code
        var extractApiTrackId = function (link) {
            if(link.startsWith("https://w.soundcloud.com/player/")) {
                trackIdMatches = link.match(/url\=(https%3A%2F%2Fapi\.soundcloud\.com%2Ftracks%2F=?)([\d]*)/)
                if(trackIdMatches.length > 1) { // found track ID
                    return trackIdMatches[2];
                } else {
                    return -1;
                }
            }
            else {
                return -1;
            }
        };
        $scope.isSoundCloudLink = function(link) {
            return extractApiTrackId(link) > 0;
        };

        $scope.generateSoundCloudIframeUrl = function(link) {
            return $sce.trustAsResourceUrl('https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/' + extractApiTrackId(link) + '&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true');
        };
        // End of SoundCloud related code


        $scope.launchResource = function(link) { //
            $window.open(link);
        };



        $scope.clearFilters = function() {
            $scope.formatFilters = [];
            $scope.categoryFilters = [];
            updateQuery();
        };

        $scope.formatFilters = [];
        var removeFormatFilter = function(format) {
            var found = $scope.formatFilters.indexOf(format);

            while (found !== -1) {
                $scope.formatFilters.splice(found, 1);
                found = $scope.formatFilters.indexOf(format);
            }
        };
        $scope.formatToggle = function(format) {
            if($scope.formatFilters.includes(format)) {
                removeFormatFilter(format);
            } else {
                $scope.formatFilters.push(format);
            }
        };

        if(!$scope.categoryFilters) $scope.categoryFilters = [];
        var removeCategoryFilter = function(category) {
            var found = $scope.categoryFilters.indexOf(category);

            while (found !== -1) {
                $scope.categoryFilters.splice(found, 1);
                found = $scope.categoryFilters.indexOf(category);
            }
            updateQuery();
        };

        $scope.categoryToggle = function(tag) {
            if($scope.categoryFilters.includes(tag)) {
                removeCategoryFilter(tag);
            } else {
                $scope.categoryFilters.push(tag);
            }
            updateQuery();
        };

        $scope.shouldResourceBeDisplayed = function(resource) {

            var category = false;
            if($scope.categoryFilters.length > 0) {
                for(var tag in resource.tags) {
                    if($scope.categoryFilters.includes(resource.tags[tag])) {
                        category = true;
                    }
                }
            } else {
                category = true;
            }

            var format = false;
            if($scope.formatFilters.length > 0) {
                if($scope.formatFilters.includes(resource.format)) {
                    format = true;
                }
            } else {
                format = true;
            }

            return category && format;

        }

    }
);</script>